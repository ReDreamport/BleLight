package org.mems;import android.content.Context;import android.graphics.Bitmap;import android.graphics.Color;import android.graphics.drawable.BitmapDrawable;import android.util.AttributeSet;import android.view.MotionEvent;import android.widget.ImageView;public class ColorChooser extends ImageView {    private Bitmap bitmap;    private ImageRGBDelegate delegate;    private int currentX, currentY;    public ColorChooser(Context context, AttributeSet attrs) {        super(context, attrs);        BitmapDrawable bd = (BitmapDrawable) getDrawable();        bitmap = bd.getBitmap();        setClickable(true);    }    public void setDelegate(ImageRGBDelegate delegate) {        this.delegate = delegate;    }    @Override    public boolean performClick() {        return super.performClick();    }    @Override    public boolean onTouchEvent(MotionEvent event) {        currentX = (int) (event.getX() * bitmap.getWidth() / getWidth());        currentY = (int) (event.getY() * bitmap.getHeight() / getHeight());        if (event.getAction() == MotionEvent.ACTION_DOWN) {            delegate.imageColor(getColor(currentX, currentY));        }        performClick();        return super.onTouchEvent(event);    }    private int getColor(int x, int y) {        int color = bitmap.getPixel(x, y);        if (color != 0) {            return color;        } else {            return Color.WHITE;        }    }    public void recycle() {        this.bitmap.recycle();    }    public interface ImageRGBDelegate {        void imageColor(int color);    }}